<!DOCTYPE html>
<html lang="en">
<head>
    <title>Story Quest with Functions</title>
    <style>
        body {
            font-family: Georgia, serif;
            max-width: 700px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .game-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .status-bar {
            display: flex;
            justify-content: space-around;
            background: #f0f0f0;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .story-text {
            font-size: 18px;
            line-height: 1.8;
            color: #333;
            margin: 20px 0;
            padding: 20px;
            background: #fafafa;
            border-left: 4px solid #764ba2;
        }
        
        .choices {
            margin: 30px 0;
        }
        
        button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            font-size: 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        
        .inventory {
            margin-top: 20px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        
        .inventory-title {
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
        }
        
        .inventory-items {
            color: #777;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>The Quest for the Crystal of Power</h1>
        
        <div class="status-bar">
            <div class="stat">
                <div class="stat-label">Health</div>
                <div class="stat-value" id="health">100</div>
            </div>
            <div class="stat">
                <div class="stat-label">Gold</div>
                <div class="stat-value" id="gold">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">Experience</div>
                <div class="stat-value" id="experience">0</div>
            </div>
        </div>
        
        <div id="story" class="story-text">
            You are a young adventurer seeking the legendary Crystal of Power. Your journey begins at the crossroads...
        </div>
        
        <div id="choices" class="choices">
            <button onclick="goToForest()">Enter the Dark Forest</button>
            <button onclick="goToVillage()">Visit the Village</button>
            <button onclick="goToMountain()">Climb the Mountain</button>
        </div>
        
        <div class="inventory">
            <div class="inventory-title">Inventory:</div>
            <div class="inventory-items" id="inventory">Empty</div>
        </div>
    </div>

    <script>
        // Game State Variables
        let playerHealth = 100;
        let playerGold = 0;
        let playerExperience = 0;
        let inventory = [];
        
        // Reusable Functions for Common Actions
        
        function updateStats() {
            document.getElementById('health').innerHTML = playerHealth;
            document.getElementById('gold').innerHTML = playerGold;
            document.getElementById('experience').innerHTML = playerExperience;
        }
        
        function updateInventory() {
            if (inventory.length === 0) {
                document.getElementById('inventory').innerHTML = "Empty";
            } else {
                document.getElementById('inventory').innerHTML = inventory.join(", ");
            }
        }
        
        function changeHealth(amount) {
            playerHealth = playerHealth + amount;
            if (playerHealth > 100) playerHealth = 100;
            if (playerHealth <= 0) {
                playerHealth = 0;
                gameOver();
            }
            updateStats();
        }
        
        function changeGold(amount) {
            playerGold = playerGold + amount;
            if (playerGold < 0) playerGold = 0;
            updateStats();
        }
        
        function gainExperience(amount) {
            playerExperience = playerExperience + amount;
            updateStats();
        }
        
        function addItem(item) {
            if (!inventory.includes(item)) {
                inventory.push(item);
                updateInventory();
                return true;
            }
            return false;
        }
        
        function hasItem(item) {
            return inventory.includes(item);
        }
        
        function updateStory(text) {
            document.getElementById('story').innerHTML = text;
        }
        
        function setChoices(choicesHTML) {
            document.getElementById('choices').innerHTML = choicesHTML;
        }
        
        // Story Functions
        
        function goToForest() {
            updateStory("The dark forest is full of mysteries. You hear strange noises coming from deeper within.");
            gainExperience(5);
            
            setChoices(
                '<button onclick="exploreDeeply()">Explore Deeply</button>' +
                '<button onclick="searchForHerbs()">Search for Herbs</button>' +
                '<button onclick="returnToCrossroads()">Return to Crossroads</button>'
            );
        }
        
        function goToVillage() {
            updateStory("The village is bustling with activity. The merchant waves you over, and you see a healer's hut nearby.");
            
            setChoices(
                '<button onclick="visitMerchant()">Visit Merchant</button>' +
                '<button onclick="visitHealer()">Visit Healer</button>' +
                '<button onclick="returnToCrossroads()">Return to Crossroads</button>'
            );
        }
        
        function goToMountain() {
            if (hasItem("Climbing Gear")) {
                updateStory("With your climbing gear, you easily scale the mountain and find a hidden cave!");
                gainExperience(20);
                setChoices(
                    '<button onclick="enterCave()">Enter the Cave</button>' +
                    '<button onclick="returnToCrossroads()">Return to Crossroads</button>'
                );
            } else {
                updateStory("The mountain is too steep to climb without proper equipment. You'll need climbing gear.");
                changeHealth(-5);
                setChoices(
                    '<button onclick="returnToCrossroads()">Return to Crossroads</button>'
                );
            }
        }
        
        function exploreDeeply() {
            updateStory("You venture deep into the forest and encounter a wolf!");
            setChoices(
                '<button onclick="fightWolf()">Fight the Wolf</button>' +
                '<button onclick="runAway()">Run Away</button>'
            );
        }
        
        function searchForHerbs() {
            updateStory("You find some healing herbs!");
            addItem("Healing Herbs");
            gainExperience(3);
            setChoices(
                '<button onclick="goToForest()">Continue Exploring</button>' +
                '<button onclick="returnToCrossroads()">Return to Crossroads</button>'
            );
        }
        
        function fightWolf() {
            if (hasItem("Sword")) {
                updateStory("With your sword, you defeat the wolf! You find 20 gold in its den.");
                changeGold(20);
                gainExperience(15);
            } else {
                updateStory("Without a weapon, the wolf injures you badly before you escape!");
                changeHealth(-30);
            }
            setChoices(
                '<button onclick="returnToCrossroads()">Return to Crossroads</button>'
            );
        }
        
        function runAway() {
            updateStory("You run away safely, but gain no experience from the encounter.");
            setChoices(
                '<button onclick="returnToCrossroads()">Return to Crossroads</button>'
            );
        }
        
        function visitMerchant() {
            updateStory("The merchant shows you his wares.");
            
            let choices = '';
            if (playerGold >= 10 && !hasItem("Sword")) {
                choices += '<button onclick="buySword()">Buy Sword (10 gold)</button>';
            }
            if (playerGold >= 15 && !hasItem("Climbing Gear")) {
                choices += '<button onclick="buyClimbingGear()">Buy Climbing Gear (15 gold)</button>';
            }
            if (playerGold >= 5 && !hasItem("Map")) {
                choices += '<button onclick="buyMap()">Buy Map (5 gold)</button>';
            }
            choices += '<button onclick="goToVillage()">Leave Shop</button>';
            
            setChoices(choices);
        }
        
        function buySword() {
            changeGold(-10);
            addItem("Sword");
            updateStory("You purchased a sword! This will help in combat.");
            visitMerchant();
        }
        
        function buyClimbingGear() {
            changeGold(-15);
            addItem("Climbing Gear");
            updateStory("You purchased climbing gear! Now you can scale the mountain.");
            visitMerchant();
        }
        
        function buyMap() {
            changeGold(-5);
            addItem("Map");
            updateStory("You purchased a map! It shows a secret path through the forest.");
            visitMerchant();
        }
        
        function visitHealer() {
            if (hasItem("Healing Herbs")) {
                updateStory("The healer takes your herbs and fully restores your health!");
                changeHealth(100);
                inventory = inventory.filter(item => item !== "Healing Herbs");
                updateInventory();
            } else {
                updateStory("The healer can help you if you bring healing herbs from the forest.");
            }
            setChoices(
                '<button onclick="goToVillage()">Leave Healer</button>'
            );
        }
        
        function enterCave() {
            if (hasItem("Map")) {
                updateStory("Using the map, you navigate the cave and find the Crystal of Power! You WIN!");
                gainExperience(100);
                setChoices(
                    '<button onclick="restart()">Play Again</button>'
                );
            } else {
                updateStory("The cave is a maze! You get lost and barely escape.");
                changeHealth(-20);
                setChoices(
                    '<button onclick="returnToCrossroads()">Return to Crossroads</button>'
                );
            }
        }
        
        function returnToCrossroads() {
            updateStory("You return to the crossroads. Where will you go next?");
            setChoices(
                '<button onclick="goToForest()">Enter the Dark Forest</button>' +
                '<button onclick="goToVillage()">Visit the Village</button>' +
                '<button onclick="goToMountain()">Climb the Mountain</button>'
            );
        }
        
        function gameOver() {
            updateStory("Your health reached zero. Game Over! You gained " + playerExperience + " experience points.");
            setChoices(
                '<button onclick="restart()">Try Again</button>'
            );
        }
        
        function restart() {
            playerHealth = 100;
            playerGold = 0;
            playerExperience = 0;
            inventory = [];
            updateStats();
            updateInventory();
            returnToCrossroads();
        }
    </script>
</body>
</html>